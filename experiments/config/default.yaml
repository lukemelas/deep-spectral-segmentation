# @package _global_
hydra:
  run:
    dir: ./outputs/${name}/${now:%Y-%m-%d}/${now:%H-%M-%S}

name: "default"
seed: 1
eval: False
fp16: False
cpu: False
wandb: False

data:
  num_classes: 1000
  train:
    root: ${env:IMAGENET_DIR}/val
  val:
    root: ${env:IMAGENET_DIR}/val
  loader:
    batch_size: 256
    num_workers: 32
    pin_memory: True
  transform:
    resize_size: 256
    crop_size: 224
    img_mean: [0.485, 0.456, 0.406]
    img_std: [0.229, 0.224, 0.225]

model:
  num_classes: ${data.num_classes}
  pretrained: False

checkpoint:
  resume: null

ema: 
  enabled: false
  decay: 0.99996
  device: 'cpu'

optimizer:
  kwargs:
    optimizer_name: 'AdamW'
    learning_rate: 1e-3
    weight_decay: 0.0
    momentum: 0.9
    filter_bias_and_bn: True

scheduler:
  epochs: 100
  sched: 'cosine'
  min_lr: 1e-5
  warmup_lr: 1e-6
  decay_epochs: 30
  warmup_epochs: 5
  cooldown_epochs: 10
  patience_epochs: 10
  decay_rate: 0.1

logging:
  print_freq: 50 

vis:
  num_images: 4